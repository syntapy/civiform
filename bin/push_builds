#!/bin/bash

PROJECT_ID=$(gcloud config get-value project)

# I used rootless docker to elliminate confusion
# on user when authenticating docker for gcr access 
# i.e. running gcloud as <user> and docker as root
# Although I (probably?) can no longer run containers 
# locally it seems
# 
# https://docs.docker.com/engine/security/rootless/
docker pull postgres
docker tag postgres gcr.io/$PROJECT_ID/postgres
docker push gcr.io/$PROJECT_ID/postgres

docker pull adminer
docker tag adminer gcr.io/$PROJECT_ID/adminer
docker push gcr.io/$PROJECT_ID/adminer

gcloud builds submit
