#! /usr/bin/env bash

# DOC: Pull the latest development environment docker image from Docker Hub unless USE_LOCAL_CIVIFORM is set.

source bin/lib.sh

PULL_SOURCE=civiform/civiform-dev:latest
LOCAL_TAG=civiform-dev

echo "Making sure we're up to date with the latest dev"

if [[ -z "${USE_LOCAL_CIVIFORM}" ]]; then
  echo "Set environment variable USE_LOCAL_CIVIFORM=1 to skip"
  if [[ -z "${PULL_PROGRESS}" ]]; then
    echo "Set environment variable PULL_PROGRESS=1 to show download progress"
    docker pull $PULL_SOURCE > /dev/null
    docker tag $PULL_SOURCE $LOCAL_TAG > /dev/null
  else
    docker pull $PULL_SOURCE
    docker tag $PULL_SOURCE $LOCAL_TAG
  fi
fi
